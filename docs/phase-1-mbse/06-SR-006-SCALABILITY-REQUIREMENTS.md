# SR-006: –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã A2D2

## –î–æ–∫—É–º–µ–Ω—Ç —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π (SRD)
**–í–µ—Ä—Å–∏—è**: 1.0
**–î–∞—Ç–∞**: 28 –æ–∫—Ç—è–±—Ä—è 2025
**–°—Ç–∞—Ç—É—Å**: –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ

---

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã A2D2, –≤–∫–ª—é—á–∞—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –∏ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –∏ –Ω–∞–≥—Ä—É–∑–∫–æ–π.

---

## 2. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

### SCL-HOR-001: Stateless –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ö–∞–∂–¥—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –º–æ–∂–µ—Ç –æ–±—Å–ª—É–∂–∏–≤–∞—Ç—å –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
- –°–µ—Å—Å–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ distributed store (Redis/Memcached)
- –ù–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- Cookies —Å–æ–¥–µ—Ä–∂–∞—Ç JWT token
- Load balancer –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏

**–ú–µ—Ç—Ä–∏–∫–∞**: –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

### SCL-HOR-002: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–≤

**–¢–µ–∫—É—â–∏–π —Ç–∞—Ä–≥–µ—Ç**:
- 1-2 —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è development
- 3-5 —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è staging
- 5-10+ —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è production

**–ú–µ—Ö–∞–Ω–∏–∑–º**:
```
Load Balancer (Round-robin, Least-connections)
    ‚îú‚îÄ‚îÄ Web Server 1 (Puma)
    ‚îú‚îÄ‚îÄ Web Server 2 (Puma)
    ‚îú‚îÄ‚îÄ Web Server 3 (Puma)
    ‚îî‚îÄ‚îÄ ...

Database (Master-Replica):
    ‚îú‚îÄ‚îÄ Master (PostgreSQL)
    ‚îî‚îÄ‚îÄ Replica (read-only)
```

**Auto-scaling rules**:
- Scale up: CPU > 70% –¥–ª—è > 5 –º–∏–Ω—É—Ç
- Scale down: CPU < 30% –¥–ª—è > 15 –º–∏–Ω—É—Ç
- Min servers: 2 (high availability)
- Max servers: 10 (cost limit)

---

### SCL-HOR-003: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**: Redis –∫–ª–∞—Å—Ç–µ—Ä

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
- Shared cache for session management
- Cache invalidation across all servers
- TTL: 30 –º–∏–Ω—É—Ç –¥–ª—è —Å–µ—Å—Å–∏–∏
- Persistence: RDB snapshots

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**:
```
Web Servers
    ‚îî‚îÄ‚îÄ Redis Master
        ‚îú‚îÄ‚îÄ Replica 1
        ‚îî‚îÄ‚îÄ Replica 2
```

---

### SCL-HOR-004: –û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**: Solid Queue (database-backed)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
- –û—á–µ—Ä–µ–¥—å –¥–æ—Å—Ç—É–ø–Ω–∞ –≤—Å–µ–º —Ä–∞–±–æ—á–∏–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**:
- –û–¥–∏–Ω —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞ —è–¥—Ä–æ
- –î–ª—è 8 —è–¥–µ—Ä - 8 —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –†–∞–±–æ—Ç–∞—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞

---

## 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

### SCL-VER-001: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ—Å—Ç–∏

**Puma settings**:
```ruby
workers ENV.fetch("WEB_CONCURRENCY") { 2 }
threads 2, 5  # Min 2, Max 5 –ø–æ—Ç–æ–∫–æ–≤ –Ω–∞ worker
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∞**:
- 1 worker –Ω–∞ 2 —è–¥—Ä–∞ CPU
- 2-5 –ø–æ—Ç–æ–∫–æ–≤ –Ω–∞ worker
- –ü—Ä–∏–º–µ—Ä: 8 —è–¥–µ—Ä = 4 workers √ó 4 –ø–æ—Ç–æ–∫–∞ = 16 –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

### SCL-VER-002: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏

**Target memory usage**:
- Per worker: < 250MB
- Per thread: < 50MB
- Rails + dependencies: ~ 100MB overhead
- –ö—ç—à –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: Controlled size

**–ú–µ—Ö–∞–Ω–∏–∑–º—ã**:
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∫—ç—à–∞
- Cleanup –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
- –ü—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏
- GC optimization

---

### SCL-VER-003: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
- Database –Ω–µ –±–æ–ª–µ–µ 70% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –¥–∏—Å–∫–∞
- Logs –Ω–µ –±–æ–ª–µ–µ 20%
- Temp files, cache < 10%
- Free space > 10% –≤—Å–µ–≥–¥–∞

**–ú–µ—Ö–∞–Ω–∏–∑–º—ã**:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
- Cleanup –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

---

## 4. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### SCL-DATA-001: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** (small-medium):
```
Single PostgreSQL server (200GB max)
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** (large):
```
Master-Replica setup:
  Master (write-heavy)
  Replica 1 (read, backups)
  Replica 2 (read, analytics)
```

**–ë—É–¥—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** (enterprise):
```
Sharding –ø–æ agent_id:
  Shard 1 (agents 0-99)
  Shard 2 (agents 100-199)
  Shard 3 (agents 200-299)
  ...
```

---

### SCL-DATA-002: –ò–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã**:
```sql
CREATE INDEX idx_tasks_agent_id ON tasks(agent_id);
CREATE INDEX idx_tasks_status ON tasks(status);
CREATE INDEX idx_tasks_created_at ON tasks(created_at);
CREATE INDEX idx_agents_status ON agents(status);
CREATE INDEX idx_agents_type ON agents(type);
```

**Composite –∏–Ω–¥–µ–∫—Å—ã**:
```sql
CREATE INDEX idx_tasks_agent_status ON tasks(agent_id, status);
CREATE INDEX idx_tasks_created_agent ON tasks(created_at, agent_id);
```

**Full-text search –∏–Ω–¥–µ–∫—Å—ã**:
```sql
CREATE INDEX idx_tasks_search ON tasks USING gin(to_tsvector('russian', title || ' ' || description));
```

---

### SCL-DATA-003: –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**Policy**:
- –ó–∞–¥–∞—á–∏ —Å—Ç–∞—Ä—à–µ 1 –≥–æ–¥–∞ - –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
- –õ–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π - –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å
- –ú–µ—Ç—Ä–∏–∫–∏ —Å—Ç–∞—Ä—à–µ 1 –º–µ—Å—è—Ü–∞ - –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å (hourly -> daily)

**–•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∞—Ä—Ö–∏–≤–∞**:
- Cold storage (S3 Glacier, Azure Archive)
- Compressed format (GZIP, Parquet)
- Still queryable through archive API

---

### SCL-DATA-004: Query –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è**:
- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ queries (> 1 —Å–µ–∫) - –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å
- –†–µ–≥—É–ª—è—Ä–Ω—ã–π EXPLAIN ANALYZE
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (Redis)
- Query timeout: 30 —Å–µ–∫ (configurable)

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã**:
```ruby
# Log slow queries
config.active_record.slow_log_threshold = 1000 # ms

# Monitor with pg_stat_statements
SELECT query, calls, mean_time
FROM pg_stat_statements
ORDER BY mean_time DESC;
```

---

## 5. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### SCL-APP-001: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –î–æ–ª–≥–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –≤–µ–±-–∑–∞–ø—Ä–æ—Å—ã

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```ruby
class ProcessAgentTask
  include Sidekiq::Worker

  def perform(task_id)
    # Heavy processing happens in background
  end
end

# Enqueue from controller
ProcessAgentTask.perform_async(task_id)
```

**SLA**:
- –ó–∞–¥–∞—á–∞ –≤ –æ—á–µ—Ä–µ–¥–∏: < 1 —Å–µ–∫
- –ù–∞—á–∞–ª–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: < 30 —Å–µ–∫
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ (1-3600 —Å–µ–∫)

---

### SCL-APP-002: Batch processing –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –º–∏–ª–ª–∏–æ–Ω–æ–≤ –∑–∞–ø–∏—Å–µ–π –±–µ–∑ –æ–±–æ—Ä–æ—Ç–∞ –ø–∞–º—è—Ç–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```ruby
# Batch processing
Task.find_each(batch_size: 1000) do |task|
  ProcessTaskJob.perform_async(task.id)
end

# Cursor-based pagination
Task.where(created_at: start_date..end_date)
    .find_each(batch_size: 1000) { |task| ... }
```

---

### SCL-APP-003: Circuit breaker –¥–ª—è external calls

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –û—Ç–∫–∞–∑ –æ–¥–Ω–æ–≥–æ –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø–∞–¥–µ–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```ruby
class LLMCallCircuitBreaker
  def initialize(provider)
    @provider = provider
    @failures = 0
  end

  def call(prompt)
    if @failures > 5
      raise CircuitBreakerOpenError
    end

    @provider.call(prompt)
  rescue StandardError => e
    @failures += 1
    raise e
  end
end
```

---

## 6. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤

### SCL-AGENT-001: –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–≥–µ–Ω—Ç–æ–≤

**–¢–∞—Ä–≥–µ—Ç –ø–æ –≤—Ä–µ–º–µ–Ω–∏**:
- 2025: 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
- 2026: 500 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤
- 2027: 1000+ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–æ–≤

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**:
- –†–µ–µ—Å—Ç—Ä –∞–≥–µ–Ω—Ç–æ–≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω (–Ω–µ –≤ –ø–∞–º—è—Ç–∏)
- Heartbeat –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞—é—Ç —Å–∏—Å—Ç–µ–º—É
- Task distribution —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏–Ω–µ–π–Ω–æ

---

### SCL-AGENT-002: Agent pooling –∏ reuse

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –∞–≥–µ–Ω—Ç–æ–≤ –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```
Agent Pool (1000 —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤)
  ‚îú‚îÄ‚îÄ 100 Analyzer agents
  ‚îú‚îÄ‚îÄ 200 Transformer agents
  ‚îú‚îÄ‚îÄ 150 Validator agents
  ‚îú‚îÄ‚îÄ 250 Reporter agents
  ‚îî‚îÄ‚îÄ 300 Integration agents
```

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ**:
- Min pool size: 10 –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ —Ç–∏–ø
- Max pool size: 100 –∞–≥–µ–Ω—Ç–æ–≤ –Ω–∞ —Ç–∏–ø
- Autoscaling: +10 –µ—Å–ª–∏ > 80% –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è

---

### SCL-AGENT-003: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–≥–µ–Ω—Ç–æ–≤

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–≤–∞–∂–¥—ã

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```ruby
class AnalyzerAgent
  def analyze(data)
    cache_key = "analysis_#{hash(data)}"
    Rails.cache.fetch(cache_key, expires_in: 1.day) do
      perform_analysis(data)
    end
  end
end
```

**Hit rate target**: 30-50%

---

## 7. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ load testing

### SCL-LOAD-001: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥ –Ω–∞–≥—Ä—É–∑–∫–æ–π

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç**: Apache JMeter, k6, –∏–ª–∏ Locust

**Test scenarios**:
1. **Normal load**: 100 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **Peak load**: 500 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. **Stress test**: –£–≤–µ–ª–∏—á–∏–≤–∞—Ç—å –¥–æ –æ—Ç–∫–∞–∑–∞

**–ú–µ—Ç—Ä–∏–∫–∏**:
- Response time (P50, P95, P99)
- Error rate
- Throughput (RPS)
- Resource usage (CPU, Memory)

---

### SCL-LOAD-002: Baseline performance

**–¶–µ–ª–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏** (–Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ):
```
Normal load (100 users):
  - P99 latency: < 1 sec
  - Error rate: 0%
  - Throughput: 100+ RPS
  - CPU: < 50%

Peak load (500 users):
  - P99 latency: < 3 sec
  - Error rate: < 1%
  - Throughput: 200+ RPS
  - CPU: < 80%
```

---

### SCL-LOAD-003: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ performance —Ç–µ—Å—Ç—ã

**CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**:
```bash
# –ó–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥—ã–π PR
k6 run performance_tests.js
  --vus 100
  --duration 5m
  --threshold 'p99 < 1000'
  --threshold 'error_rate < 0.01'
```

---

## 8. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥—É –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

### SCL-MON-001: Tracking –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

**–ú–µ—Ç—Ä–∏–∫–∏**:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤ –≤ —Å–∏—Å—Ç–µ–º–µ
- –†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á
- Database —Ä–∞–∑–º–µ—Ä
- Cache hit rate
- Response time vs load (trend)

**–¶–µ–ª—å**: –í—ã—è–≤–∏—Ç—å —Ç–æ—á–∫—É –æ—Ç–∫–∞–∑–∞ —Ä–∞–Ω—å—à–µ, —á–µ–º –æ–Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞

---

### SCL-MON-002: –ü–ª–∞–Ω–∏—Ä–æ–≤–∫–∞ capacity

**Quarterly review**:
- –ê–Ω–∞–ª–∏–∑ growth rate
- Projection –Ω–∞ 6 –º–µ—Å—è—Ü–µ–≤
- –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ hardware

**Growth assumptions**:
- Agents: 20% –≤ –≥–æ–¥
- Tasks: 50% –≤ –≥–æ–¥
- Storage: 30% –≤ –≥–æ–¥

---

## 9. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—é –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

### SCL-DESIGN-001: API pagination

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ù–µ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –±–æ–ª–µ–µ 1000 –∑–∞–ø–∏—Å–µ–π –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è**:
```ruby
# Cursor-based pagination
GET /api/v1/tasks?limit=100&cursor=abc123

# Response
{
  "data": [...],
  "pagination": {
    "next_cursor": "def456",
    "has_more": true,
    "limit": 100
  }
}
```

---

### SCL-DESIGN-002: Caching strategy

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –°–Ω–∏–∑–∏—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ database —á–µ—Ä–µ–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**Levels**:
1. HTTP –∫—ç—à (Etag, Cache-Control)
2. Application –∫—ç—à (Rails cache)
3. Database –∫—ç—à (native caching)
4. CDN –∫—ç—à (static content)

**Policy**:
- –ê–≥–µ–Ω—Ç—ã: Cache 1 —á–∞—Å
- –ó–∞–¥–∞—á–∏: Cache 5 –º–∏–Ω—É—Ç
- –ú–µ—Ç—Ä–∏–∫–∏: Cache 15 –º–∏–Ω—É—Ç
- Static content: Cache 1 –≥–æ–¥

---

### SCL-DESIGN-003: Message queuing –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

**–û—á–µ—Ä–µ–¥—å –∑–∞–¥–∞—á**:
- –°–∏—Å—Ç–µ–º–∞ –æ—á–µ—Ä–µ–¥–µ–π –≤ database (Solid Queue)
- –ö–æ–ª-–≤–æ —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ = –∫–æ–ª-–≤–æ —è–¥–µ—Ä
- Autoscaling —Ä–∞–±–æ—á–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

---

## 10. Roadmap –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

### 2025 (Current - 100 –∞–≥–µ–Ω—Ç–æ–≤)
- ‚úì Single server with database replication
- ‚úì Redis for caching
- ‚úì Load balancer for web servers
- ‚úì Background job processing

### 2026 (500 –∞–≥–µ–Ω—Ç–æ–≤)
- [ ] Database sharding by agent_id
- [ ] Distributed tracing (OpenTelemetry)
- [ ] Elasticsearch for search
- [ ] gRPC for internal communication

### 2027+ (1000+ –∞–≥–µ–Ω—Ç–æ–≤)
- [ ] Kubernetes orchestration
- [ ] Service mesh (Istio)
- [ ] Event streaming (Kafka)
- [ ] Microservices architecture

---

## 11. –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏

–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–º, –∫–æ–≥–¥–∞:

1. ‚úì Load —Ç–µ—Å—Ç—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ü–µ–ª–µ–≤—ã–º –º–µ—Ç—Ä–∏–∫–∞–º
2. ‚úì –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä –±–µ–∑ downtime
3. ‚úì Performance –¥–µ–≥—Ä–∞–¥–∏—Ä—É–µ—Ç –ª–∏–Ω–µ–π–Ω–æ —Å —Ä–æ—Å—Ç–æ–º –Ω–∞–≥—Ä—É–∑–∫–∏
4. ‚úì Monitoring –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–≥–¥–∞ —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
5. ‚úì –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å**: üü¢ –£—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –∏ RTM (Requirements Traceability Matrix)
